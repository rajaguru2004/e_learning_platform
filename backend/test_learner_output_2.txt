[dotenv@17.2.4] injecting env (12) from .env -- tip: ⚙️  enable debug logging with { debug: true }
Starting Learner Quiz Implementation Test...
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email", "public"."users"."password", "public"."users"."role_id", "public"."users"."is_active", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" LEFT JOIN "public"."roles" AS "j1" ON ("j1"."id") = ("public"."users"."role_id") WHERE ("j1"."code" = $1 AND ("j1"."id" IS NOT NULL)) LIMIT $2 OFFSET $3
Creating course...
prisma:query SELECT "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."instructor_id", "public"."courses"."category_id", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."is_active", "public"."courses"."review_note", "public"."courses"."reviewed_by", "public"."courses"."reviewed_at", "public"."courses"."is_locked", "public"."courses"."created_at", "public"."courses"."updated_at" FROM "public"."courses" WHERE ("public"."courses"."slug" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."course_status_types"."id", "public"."course_status_types"."code", "public"."course_status_types"."description", "public"."course_status_types"."is_active", "public"."course_status_types"."created_at" FROM "public"."course_status_types" WHERE ("public"."course_status_types"."code" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query BEGIN
prisma:query INSERT INTO "public"."courses" ("id","title","slug","description","instructor_id","status_code","visibility_code","access_code","price","discounted_price","duration","enrollment_count","average_rating","total_reviews","is_active","is_locked","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18) RETURNING "public"."courses"."id"
prisma:query SELECT "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."instructor_id", "public"."courses"."category_id", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."is_active", "public"."courses"."review_note", "public"."courses"."reviewed_by", "public"."courses"."reviewed_at", "public"."courses"."is_locked", "public"."courses"."created_at", "public"."courses"."updated_at" FROM "public"."courses" WHERE "public"."courses"."id" = $1 LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query INSERT INTO "public"."topics" ("id","course_id","title","order_index","is_active","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."topics"."id", "public"."topics"."course_id", "public"."topics"."title", "public"."topics"."description", "public"."topics"."order_index", "public"."topics"."is_active", "public"."topics"."created_at", "public"."topics"."updated_at"
prisma:query INSERT INTO "public"."subtopics" ("id","topic_id","title","video_url","duration","order_index","is_active","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING "public"."subtopics"."id", "public"."subtopics"."topic_id", "public"."subtopics"."title", "public"."subtopics"."description", "public"."subtopics"."video_url", "public"."subtopics"."duration", "public"."subtopics"."order_index", "public"."subtopics"."is_active", "public"."subtopics"."created_at", "public"."subtopics"."updated_at"
prisma:query INSERT INTO "public"."questions" ("id","subtopic_id","question_type_id","question_text","options","correct_answer","points","order_index","is_active","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11) RETURNING "public"."questions"."id", "public"."questions"."subtopic_id", "public"."questions"."question_type_id", "public"."questions"."question_text", "public"."questions"."options", "public"."questions"."correct_answer", "public"."questions"."points", "public"."questions"."order_index", "public"."questions"."is_active", "public"."questions"."created_at", "public"."questions"."updated_at"
prisma:query COMMIT
prisma:query SELECT "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."instructor_id", "public"."courses"."category_id", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."is_active", "public"."courses"."review_note", "public"."courses"."reviewed_by", "public"."courses"."reviewed_at", "public"."courses"."is_locked", "public"."courses"."created_at", "public"."courses"."updated_at" FROM "public"."courses" WHERE ("public"."courses"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."topics"."id", "public"."topics"."course_id", "public"."topics"."title", "public"."topics"."description", "public"."topics"."order_index", "public"."topics"."is_active", "public"."topics"."created_at", "public"."topics"."updated_at" FROM "public"."topics" WHERE "public"."topics"."course_id" IN ($1) ORDER BY "public"."topics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."subtopics"."id", "public"."subtopics"."topic_id", "public"."subtopics"."title", "public"."subtopics"."description", "public"."subtopics"."video_url", "public"."subtopics"."duration", "public"."subtopics"."order_index", "public"."subtopics"."is_active", "public"."subtopics"."created_at", "public"."subtopics"."updated_at" FROM "public"."subtopics" WHERE "public"."subtopics"."topic_id" IN ($1) ORDER BY "public"."subtopics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."questions"."id", "public"."questions"."subtopic_id", "public"."questions"."question_type_id", "public"."questions"."question_text", "public"."questions"."options", "public"."questions"."correct_answer", "public"."questions"."points", "public"."questions"."order_index", "public"."questions"."is_active", "public"."questions"."created_at", "public"."questions"."updated_at" FROM "public"."questions" WHERE "public"."questions"."subtopic_id" IN ($1) ORDER BY "public"."questions"."order_index" ASC OFFSET $2
Publishing course...
prisma:query UPDATE "public"."courses" SET "status_code" = $1, "is_active" = $2, "updated_at" = $3 WHERE ("public"."courses"."id" = $4 AND 1=1) RETURNING "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."instructor_id", "public"."courses"."category_id", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."is_active", "public"."courses"."review_note", "public"."courses"."reviewed_by", "public"."courses"."reviewed_at", "public"."courses"."is_locked", "public"."courses"."created_at", "public"."courses"."updated_at"
Testing learnerService.getAllCourses...
prisma:query SELECT COUNT(*) FROM (SELECT "public"."courses"."id" FROM "public"."courses" WHERE ("public"."courses"."status_code" = $1 AND "public"."courses"."is_active" = $2 AND ("public"."courses"."title" ILIKE $3 OR "public"."courses"."description" ILIKE $4)) OFFSET $5) AS "sub"
prisma:query SELECT "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."created_at", "public"."courses"."instructor_id" FROM "public"."courses" WHERE ("public"."courses"."status_code" = $1 AND "public"."courses"."is_active" = $2 AND ("public"."courses"."title" ILIKE $3 OR "public"."courses"."description" ILIKE $4)) ORDER BY "public"."courses"."created_at" DESC LIMIT $5 OFFSET $6
prisma:query SELECT "public"."users"."id", "public"."users"."name" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."topics"."id", "public"."topics"."course_id", "public"."topics"."title", "public"."topics"."description", "public"."topics"."order_index", "public"."topics"."is_active", "public"."topics"."created_at", "public"."topics"."updated_at" FROM "public"."topics" WHERE "public"."topics"."course_id" IN ($1) ORDER BY "public"."topics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."subtopics"."id", "public"."subtopics"."topic_id", "public"."subtopics"."title", "public"."subtopics"."description", "public"."subtopics"."video_url", "public"."subtopics"."duration", "public"."subtopics"."order_index", "public"."subtopics"."is_active", "public"."subtopics"."created_at", "public"."subtopics"."updated_at" FROM "public"."subtopics" WHERE "public"."subtopics"."topic_id" IN ($1) ORDER BY "public"."subtopics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."questions"."id", "public"."questions"."subtopic_id", "public"."questions"."question_type_id", "public"."questions"."question_text", "public"."questions"."options", "public"."questions"."correct_answer", "public"."questions"."points", "public"."questions"."order_index", "public"."questions"."is_active", "public"."questions"."created_at", "public"."questions"."updated_at" FROM "public"."questions" WHERE "public"."questions"."subtopic_id" IN ($1) ORDER BY "public"."questions"."order_index" ASC OFFSET $2
getAllCourses: Questions present? true
✅ getAllCourses returned questions
Testing learnerService.getCourseDetails...
prisma:query SELECT "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."created_at", "public"."courses"."instructor_id" FROM "public"."courses" WHERE ("public"."courses"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."users"."id", "public"."users"."name", "public"."users"."email" FROM "public"."users" WHERE "public"."users"."id" IN ($1) OFFSET $2
prisma:query SELECT "public"."topics"."id", "public"."topics"."course_id", "public"."topics"."title", "public"."topics"."description", "public"."topics"."order_index", "public"."topics"."is_active", "public"."topics"."created_at", "public"."topics"."updated_at" FROM "public"."topics" WHERE "public"."topics"."course_id" IN ($1) ORDER BY "public"."topics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."subtopics"."id", "public"."subtopics"."topic_id", "public"."subtopics"."title", "public"."subtopics"."description", "public"."subtopics"."video_url", "public"."subtopics"."duration", "public"."subtopics"."order_index", "public"."subtopics"."is_active", "public"."subtopics"."created_at", "public"."subtopics"."updated_at" FROM "public"."subtopics" WHERE "public"."subtopics"."topic_id" IN ($1) ORDER BY "public"."subtopics"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."questions"."id", "public"."questions"."subtopic_id", "public"."questions"."question_type_id", "public"."questions"."question_text", "public"."questions"."options", "public"."questions"."correct_answer", "public"."questions"."points", "public"."questions"."order_index", "public"."questions"."is_active", "public"."questions"."created_at", "public"."questions"."updated_at" FROM "public"."questions" WHERE "public"."questions"."subtopic_id" IN ($1) ORDER BY "public"."questions"."order_index" ASC OFFSET $2
prisma:query SELECT "public"."course_reviews"."id", "public"."course_reviews"."rating", "public"."course_reviews"."review_text", "public"."course_reviews"."created_at", "public"."course_reviews"."user_id", "public"."course_reviews"."course_id" FROM "public"."course_reviews" WHERE ("public"."course_reviews"."is_published" = $1 AND "public"."course_reviews"."course_id" IN ($2)) ORDER BY "public"."course_reviews"."created_at" DESC LIMIT $3 OFFSET $4
getCourseDetails: Questions present? true
✅ getCourseDetails returned questions
Cleaning up...
prisma:query DELETE FROM "public"."courses" WHERE ("public"."courses"."id" = $1 AND 1=1) RETURNING "public"."courses"."id", "public"."courses"."title", "public"."courses"."slug", "public"."courses"."description", "public"."courses"."instructor_id", "public"."courses"."category_id", "public"."courses"."status_code", "public"."courses"."visibility_code", "public"."courses"."access_code", "public"."courses"."thumbnail_url", "public"."courses"."price", "public"."courses"."discounted_price", "public"."courses"."duration", "public"."courses"."enrollment_count", "public"."courses"."average_rating", "public"."courses"."total_reviews", "public"."courses"."is_active", "public"."courses"."review_note", "public"."courses"."reviewed_by", "public"."courses"."reviewed_at", "public"."courses"."is_locked", "public"."courses"."created_at", "public"."courses"."updated_at"
